<style type="text/css">
	.item_form label {
		width: 112px;
	}
	#editBox table tr td,#editBox table{
		text-align: left;
		border:none !important;
	}
	#editBox table tr td{
		height: 35px;
	}
	#templateBox input{height:30px;width:180px;padding-left:5px;}	
</style>
<div class="widget-main">
	<div class="row">
		<!-- <h3 class="header smaller lighter blue">合作客户</h3> -->
		<div class="actions" id="topTool">
			<div class="col-sx-4" style=" float: left; margin-right: 5px;">
				<div class="search">
					<i class="search-icon"></i>
					<input type="text" pts="0" sear="khm_customer.name" class="search-input" placeholder="企业名称">
				</div>
			</div>
			<div class="col-sx-4" style=" float: left; margin-right: 5px;">
				<div class="search">
					<i class="search-icon"></i>
					<input type="text" pts="0" sear="khm_customer.customer_num" class="search-input" placeholder="客户编码">
				</div>
			</div>
			<div class="col-sx-4" style=" float: left; margin-right: 5px;">
				<button type="button" id="search" title="搜索" class="btn btn-info btn-sm">
	                <i class="fa fa-search"></i>
	            </button>
			</div>
			<div class="col-sx-4" style=" float: left;  margin-right: 5px; ">
				<button id="heightsearch" title="高级搜索" type="button" class="btn btn-info btn-sm" style="background-color: #00c0ef !important;">
                    <i class="fa fa-filter"></i>
                </button>
			</div>
			<div class="col-sx-4" style=" float: left; margin-right: 5px;">
				<button id="flush" title="刷新" type="button" class="btn btn-info btn-sm" style="background-color: #32CD32	 !important;">
                    <i class="fa fa-refresh"></i>
                </button>
			</div>

<!--
			<div class="col-sx-4" style=" float: left; margin-right: 5px;">
				<button type="button"  title="导出" style="outline: none;background-color: #1E9FFF !important; border-color: #1E9FFF;" class="exportfile moveToClue btn addBtn btn-info btn-sm position-relative">
					<i class="fa fa-sign-out"></i>
				</button>
			</div>-->

			<!--高级搜索-->	
							
			<div id="heightsearch1" class="col-sx-12" style="position: absolute; background: #fff; z-index: 1041;overflow: auto; padding: 10px 0px; display: none;margin-top: 30px;">
				<div class="row">
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
						<label>企业名称</label>
						<select>
							<option> = </option>
						</select>
						<input type="text" gjs=0 sear="khm_customer.name" />
					</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
						<label>客户编码</label>
						<select>
							<option> = </option>
						</select>
						<input type="text" gjs=0 sear="khm_customer.customer_num" />
					</div>

					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
						<label>客户级别</label>
						<select>
							<option> = </option>
						</select>
						<select style="width:180px" gjs=0 sear="khm_customer.rank">
							<option value=""> 请选择 </option>
							<option value="1">A</option>
							<option value="2">B</option>
							<option value="3">C</option>
							<option value="4">D</option>
						</select>
					</div>
						
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
						<label>来源</label>
						<select>
							<option> = </option>
						</select>
						<select style="width:180px" gjs=0 sear="khm_customer.source">
							<option value=""> 请选择 </option>
							<option value="转介绍">转介绍</option>
							<option value="电话咨询">电话咨询</option>
							<option value="线上注册">线上注册</option>
							<option value="客户上门">客户上门</option>
							<option value="陌生拜访">陌生拜访</option>
							<option value="公司资源">公司资源</option>
							<option value="个人资源">个人资源</option>
							<option value="广告宣传">广告宣传</option>
							<option value="电话营销">电话营销</option>
						</select>
					</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
						<label>介绍人</label>
						<select>
							<option> = </option>
						</select>
						<input type="text" gjs=0 sear="khm_customer.introduce">
					</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
						<label>统一社会信用代码</label>
						<select>
							<option> = </option>
						</select>
						<input type="text" gjs=0 sear="khm_customer.social_credit_code">
					</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>法定代表人</label>
							<select>
								<option> = </option>
							</select>
							<input type="text" sear="khm_customer.corporation" gjs="0" />
						</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>法人身份证号码</label>
							<select>
								<option> = </option>
							</select>
							<input type="text" gjs=0 sear="khm_customer.corporation_card">
						</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>注册资金</label>
							<select>
								<option> = </option>
								<option> &lt; </option>
								<option> > </option>
							</select>
							<input type="text" gjs=0 sear="khm_customer.register_capital" data-type="gj">
						</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>省市区</label>
							<select>
								<option> = </option>
							</select>
							<input type="text" gjs=0 sear="khm_customer.area">
						</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>行业</label>
							<select>
								<option> = </option>
							</select>
							<select gjs=0 sear="khm_customer.industry" data-type="gj" style="width:180px;">
								<option value="">请选择</option>
								<option value="1">批发零售业</option>
								<option value="2">制造业</option>
								<option value="3">租赁和商务服务业</option>
								<option value="4">仓储运输业</option>
								<option value="5">餐饮住宿业</option>
								<option value="6">信息软件业</option>
								<option value="7">金融业</option>
								<option value="8">房地产业</option>
								<option value="9">建筑业</option>
								<option value="10">教育</option>
								<option value="11">文体娱乐业</option>
								<option value="12">卫生和社会工作</option>
								<option value="13">居民服务</option>
								<option value="14">修理业</option>
								<option value="15">农林牧渔业</option>
							</select>
						</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>经营范围</label>
							<select>
								<option> = </option>
							</select>
							<input type="text" gjs=0 sear="khm_customer.range">
						</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>公司规模</label>
							<select>
								<option> = </option>
							</select>
							<!--<input type="text" gjs=0 sear="khm_customer.scale">-->
							<select style="width: 180px" gjs=0 sear="khm_customer.scale"   >
								<option value="">请选择</option>
								<option value="10人以下">10人以下</option>
								<option value="10-50人">10-50人</option>
								<option value="50-100人">50-100人</option>
								<option value="100-200人">100-200人</option>
								<option value="200人以上">200人以上</option>
							</select>
						</div>
					<div class="col-sx-4" style=" float: left; margin-bottom:5px;">
							<label>成立日期</label>
							<select>
								<option> = </option>
								<option> &lt; </option>
								<option> > </option>
							</select>
							
							<div class="input-group" style="display: inline-flex; width: 180px;">
								<span class="input-group-addon">
							<i class="fa fa-calendar bigger-110"></i>
							</span>
								<input class="form-control" type="text" data-status="rangtime" gjs=0 sear="khm_customer.stablish_time" name="date-range-picker" id="id-date-range-picker-1" />
							</div>
							
						</div>
					
					<div class="col-sx-4" style="clear:both;padding-top:10px;text-align:center;">
						<button type="button" id="search1" class="search1 btn btn-info btn-sm" style="width:180px;">
	                        查询
	                    </button>
	                    <button type="button" id="rest" class=" btn btn-info btn-sm" style="width:180px;">
		                       重置
		                    </button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="custom_table">
		<table id="dynamic-table">
			<thead>
				<tr class="thColor">
					<th>操作</th>
					<th data-num="2">客户编号</th>
					<th data-num="3">企业名称</th>
					<th data-num="4" >客户级别</th>
					<th data-num="5">来源</th>
					<th data-num="6">介绍人</th>
					<th data-num="7">统一社会信用代码</th>
					<th data-num="8">法定代表人</th>
					<th data-num="9">法人身份证号</th>
					<th data-num="10" style="text-align: right !important;">注册资金(万)</th>
					<th data-num="11">成立日期</th>
					<th data-num="12">省市区</th>
					<th data-num="13">详细地址</th>
					<th data-num="14">行业</th>
					<th data-num="15">经营范围</th>
					<th data-num="16">公司规模</th>
				</tr>
			</thead>
			<tbody id="datalist">

			</tbody>
		</table>
	</div>
	<div align="center" style="margin-top: 20px; margin-bottom: 20px;">
		<div align="left" style="padding-left: 15px; float: left; width: 10%;" id="num"></div>
		<!--<div id="pagination" style="float: left; width: 80%; height: 25px;"></div>-->
		<div id="pageBar" class="pagination"></div>
		<div align="right" style="float: right;  width: 10%;">
			<select style="width: 100px;" id="changePageNum">
				<option value="10">每页10条</option>
				<option value="20">每页20条</option>
				<option value="50">每页50条</option>
				<option value="100">每页100条</option>
				<option value="200">每页200条</option>
			</select>
		</div>
	</div>
	<div class="row" id="template" style="display:none;width:678px;">
			<div class="col-sm-12" id="editBox">				
				<table width="100%" style="border:1px solid #ddd;border-collapse:collapse;margin-bottom:15px;">
				<tr style="border-bottom:1px solid #d7d7d7;">
					<td colspan="4" style="color:#116ed1">基本信息</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">客户编号：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData0"></span>
					</td>
					<td style="text-align: right !important">客户名称：</td>
					<td style="text-align: left !important">
						<span class="disData1"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">客户级别：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData2"></span>
					</td>
					<td style="text-align: right !important">来源：</td>
					<td style="text-align: left !important">
						<span class="disData3"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">介绍人：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData4"></span>
					</td>
					<td style="text-align: right !important">统一社会信用代码：</td>
					<td style="text-align: left !important">
						<span class="disData5"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">法定代表人：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData6"></span>
					</td>
					<td style="text-align: right !important">法人身份证号：</td>
					<td style="text-align: left !important">
						<span class="disData7"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">注册资金(万)：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData8"></span>
					</td>
					<td style="text-align: right !important">成立日期：</td>
					<td style="text-align: left !important">
						<span class="disData9"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">省市区：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData10"></span>
					</td>
					<td style="text-align: right !important">详细地址：</td>
					<td style="text-align: left !important">
						<span class="disData11"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">行业：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData12"></span>
					</td>
					<td style="text-align: right !important">公司规模：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData14"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">联系人：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData38"></span>
					</td>
					<td style="text-align: right !important">手机：</td>
					<td style="text-align: left !important">
						<span class="disData39"></span>
					</td>
				</tr>
				<tr style="">

					<td style="text-align: right !important">电话：</td>
					<td colspan="4"  style="text-align: left !important">
						<span class="disData40"></span>
					</td>
				</tr>
				<tr style="">
					
					<td style="text-align: right !important">经营范围：</td>
					<td colspan="4"  style="text-align: left !important">
						<span class="disData13"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">备注：</td>
					<td colspan="4"  style="text-align: left !important">
						<span class="disData15"></span>
					</td>
				</tr>
				<tr style="border-bottom:1px solid #d7d7d7;">
					<td colspan="4" style="color:#116ed1">税务信息</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">税务类型：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData16"></span>
					</td>
					<td style="text-align: right !important">有无基本户：</td>
					<td style="text-align: left !important">
						<span class="disData17"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">纳税识别号：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData18"></span>
					</td>
					<td style="text-align: right !important">国税编码：</td>
					<td style="text-align: left !important">
						<span class="disData19"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">国税密码：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData20"></span>
					</td>
					<td style="text-align: right !important">国税CA证书：</td>
					<td style="text-align: left !important">
						<span class="disData21"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">地税编码：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData22"></span>
					</td>
					<td style="text-align: right !important">地税密码：</td>
					<td style="text-align: left !important">
						<span class="disData23"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">地税CA证书：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData24"></span>
					</td>
					<!--<td style="text-align: right !important">工商编码：</td>
					<td style="text-align: left !important">
						<span class="disData25"></span>
					</td>-->
				</tr>
				<!--<tr style="">
					<td style="text-align: right !important">工商密码：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData26"></span>
					</td>
					<td style="text-align: right !important">工商CA证书：</td>
					<td style="text-align: left !important">
						<span class="disData27"></span>
					</td>
				</tr>-->
				<tr style="border-bottom:1px solid #d7d7d7;">
					<td colspan="4" style="color:#116ed1">系统信息</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">客户状态：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData28"></span>
					</td>
					<td style="text-align: right !important">最后修改人：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData29"></span>
					</td>
					<!-- <td style="text-align: right !important">转手次数：</td>
					<td style="text-align: left !important">
						<span class="disData29"></span>
					</td> -->
				</tr>
				<!-- <tr style="">
					<td style="text-align: right !important">负责人：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData30"></span>
					</td>
					<td style="text-align: right !important">负责人所在部门：</td>
					<td style="text-align: left !important">
						<span class="disData31"></span>
					</td>
				</tr> -->
				<tr style="">
					<td style="text-align: right !important">所属公海：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData32"></span>
					</td>
					<td style="text-align: right !important">失效原因：</td>
					<td style="text-align: left !important">
						<span class="disData33"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">失效操作人：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData34"></span>
					</td>
					<td style="text-align: right !important">失效操作人所在部门：</td>
					<td style="text-align: left !important">
						<span class="disData35"></span>
					</td>
				</tr>
				<tr style="">
					<td style="text-align: right !important">创建人 : </td>
					<td style="text-align: left !important">
						<span class="disData36"></span>
					</td>
					
					<td style="text-align: right !important">创建人所在部门：</td>
					<td style="text-align: left !important" class="tdboder">
						<span class="disData37"></span>
					</td>
				</tr>
				
			</table>
			</div>
		</div>
		<!--编辑信息-->
		<div class="row" id="template1" style="display:none;">
			<div style="margin-top:15px;">
				<label> 企业名称： </label>
				<input class="required" title_="name" />
				<label> 客户级别： </label>
				<select style="width:180px;" class="required" title_="rank">
					<option value=""> 请选择 </option>
					<option value="1">A</option>
					<option value="2">B</option>
					<option value="3">C</option>
					<option value="4">D</option>
				</select>
			</div>
			<div style="margin-top:15px;">
				<label> 来源： </label>
				<select style="width:180px;" class="source required" title_="source">
					<option> 请选择 </option>
					<option>转介绍</option>
					<option>电话咨询</option>
					<option>线上注册</option>
					<option>客户上门</option>
					<option>陌生拜访</option>
					<option>公司资源</option>
					<option>个人资源</option>
					<option>广告宣传</option>
					<option>电话营销</option>
				</select>
				<span class="introducer">
					<label class="introducer required" style="display:none;"> 介绍人： </label>
				<select class="introducer" id="introducer" style="width:180px;display:none;" title_="introduce" >
				</select>
				</span>
			</div>
			<div style="margin-top:15px;">
				<label> 统一社会信用代码： </label>
				<input title_="social_credit_code" maxlength="18" />
				<label> 法定代表人： </label>
				<input title_="corporation" />
			</div>
			<div style="margin-top:15px;">
				<label><i class='reqired_label'>*</i> 法人身份证号： </label>
				<input title_="corporation_card" msg="请输入正确的身份证号码" validate="/\w/g" />
				<label> 行业： </label>
				<select class="" style="width:180px;" title_="industry" >
					<option value="">---请选择---</option>
					<option value="1">批发零售业</option>
					<option value="2">制造业</option>
					<option value="3">租赁和商务服务业</option>
					<option value="4">仓储运输业</option>
					<option value="5">餐饮住宿业</option>
					<option value="6">信息软件业</option>
					<option value="7">金融业</option>
					<option value="8">房地产业</option>
					<option value="9">建筑业</option>
					<option value="10">教育</option>
					<option value="11">文体娱乐业</option>
					<option value="12">卫生和社会工作</option>
					<option value="13">居民服务</option>
					<option value="14">修理业</option>
					<option value="15">农林牧渔业</option>
				</select>
			</div>
			<div style="margin-top:15px;">
			<label><i class='reqired_label'>*</i> 注册资金(万)： </label>
			<input type="number" style="width:180px;" title_="register_capital"  msg="请输入大于零的注册资金" validate="morezero"/>
			</div>
			<div style="margin-top:15px;">
			<label> 省市区：</label>
			<span id="city" title_="area">
					<select class="prov"></select>
					<select class="city" disabled="disabled"></select>
					<select class="dist" disabled="disabled"></select>
			</span>
			</div>
			<div style="margin-top:15px;">
				<label> 详细地址： </label>
				<input style="width:calc(100% - 135px);margin-left:5px;padding:5px;" title_="address" />
			</select>
			</div>
			<div style="margin-top:15px;">
				<label>联系人：</label>
				<input type="text" style="width:180px;" title_="contacts"/>
				<label>手机号码：</label>
				<input style="width:180px;" title_="phone"/>
			</div>
			<div style="margin-top:15px;">
				<label>电话号码： </label>
				<input style="width:180px;" title_="tel"/>
				<label> 经营范围： </label>
				<input title_="range" />
			</div>
			<div style="margin-top:15px;">
				<label> 公司规模： </label>
				<select style="width: 180px;" title_="scale" >
					<option value="">请选择</option>
					<option value="10人以下">10人以下</option>
					<option value="10-50人">10-50人</option>
					<option value="50-100人">50-100人</option>
					<option value="100-200人">100-200人</option>
					<option value="200人以上">200人以上</option>
				</select>
				<label> 成立日期： </label>
				<div class="input-group" style="display: inline-flex; width: 180px;">
					<input class="date-timepicker1" title_="stablish_time" style="height: 30px; width:inherit;">
					<span class="input-group-addon" style="width:30px;height:30px;position:absolute;right:0;border-left:1px solid #ddd;">
					<i class="fa fa-clock-o bigger-110" style="position:relative;right:3px;"></i>
				</span>
				</div>
				<!--<div class="input-group" style="display: inline-flex; width: 180px;">
					<input id="date-timepicker1" class="date-timepicker1" search="" data-id="oppo_time" title_="stablish_time">
					<span style="display: inline-block;height: 28px;background: #ddd;width: 26px;position: relative;top: -6px;right: 31px;">
							<i class="fa fa-clock-o bigger-110" style="    position: relative;left: 7px;top: 5px;"></i>
					</span>
				</div>-->
			</div>
			<div style="margin-top:15px;">
				<label style="float:left;"> 备注： </label>
				<textarea title_="remark" style="width:calc(100% - 131px);margin-left:5px;resize:none;padding:5px;" class="in_remark"></textarea>
			</div>

			<div style="text-align:center;margin-top:15px;">
				<span style="position:relative;left:65px;font-weight:bold;cursor:pointer;display: inline-block;background: #337ab7;padding: 3px 5px; color:#fff;border-radius: 5px;" class="more">填写更多</span>
			</div>

			<div style="display:none" class="taxMsg">
				<div style="margin-top:15px;">
					<label> 税务类型： </label>
					<select title_="tax_type" class="required" style="width:180px;" msg="请选择税务类型">
						<option> 请选择 </option>
						<option value="1">一般纳税人</option>
						<option value="2">小规模</option>
					</select>
					<label> 有无基本户： </label>
					<select title_="basic" class="required" style="width:180px;" msg="请选择有无基本户">
						<option> 请选择 </option>
						<option value="1">有</option>
						<option value="2">无</option>
					</select>
				</div>
				<div style="margin-top:15px;">
					<label> <i class='reqired_label'>*</i>纳税识别号： </label>
					<input title_="ratepaying_no" class="required" msg="纳税识别号不能为空" maxlength="20" />
					<label> 国税编码： </label>
					<input title_="state_tax_no" />
				</div>
				<div style="margin-top:15px;">
					<label><i class='reqired_label'>*</i> 国税密码： </label>
					<input title_="state_tax_pass" class="required" msg="国税密码不能为空"  />
					<label> 国税CA证书： </label>
					<input title_="gca" />
				</div>
				<div style="margin-top:15px;">
					<label> 地税编码： </label>
					<input title_="local_tax_no" />
					<label><i class='reqired_label'>*</i> 地税密码： </label>
					<input title_="local_tax_pass" class="required" msg="地税密码不能为空"   />
				</div>
					<div style="margin-top:15px;">
					<label> 地税CA证书： </label>
					<input title_="dca" />
					<!--<label> 工商编码： </label>
					<input title_="industry_no" />-->
				</div>
				<!--<div style="margin-top:15px;">
					<label><i class='reqired_label'>*</i> 工商密码： </label>
					<input title_="industry_pass"  class="required" msg="请输入正确的工商密码"/>
					<label> 工商CA证书： </label>
					<input title_="ica" />
				</div>-->
			</div>
			<div style="text-align:center;margin-top:15px;">
				<span class="msg" style="margin-left:calc(50% - 49px);float:left;line-height:34px;display:none;color:red;"></span>

				<button class="sure_button add">
                        <i class="fa fa-check" aria-hidden="true"></i>
                        保存
                    </button>
			</div>
		</div>
	{% include 'admin/mark.html' %} {% include 'admin/customerDetail.html' %}
</div>
<script src="/resource/adimin/assets/js/src/public.js"></script>
<script src="/resource/adimin/assets/js/src/jquery.cityselect.js"></script>
<script type="text/javascript">
	$(function() {
		var pagesize = 10;
		var filter = '';
		var employees = [];
		var employees_2 = [];
		var order ='khm_customer.id desc ';
/*
		//导出功能
        cs.exportFile({
            url:"/api/api_customer/export",
            title:"合作客户"
        });*/


		$('#changePageNum').change(function() {
			pagesize = $(this).val();
			getList(1);
		})
		doSearch();			
		//来自详情页面的跳转
		fromDetail();
		function fromDetail(){
			if (ykp.getCookie('data-id')!=undefined&&ykp.getCookie('data-id')!='') {
				var id = ykp.getCookie('data-id');
				var filter = 'khm_customer.id='+id;
				getList(1,filter);
				ykp.setCookie('data-id','');
			}else{
				ykp.setCookie("filter", "");
				ykp.setCookie("where", "");
				getList(1);
			}
		}
		cs.dataRang();
		//通用排序
		cs.general_sort({
			url: '/api/api_customer/customer',
			method: 'post',
			data: {
				filter:filter,
				limit: pagesize,
				type:2
			},
			pageBar: {
				id: '#pageBar'
			},
			initOrder:'khm_customer.id',
			defaultOrder: order,
			contentId: "#dataList",
			params:[{
				id: "#dynamic-table",
				field:["","khm_customer.id","khm_customer.name","khm_customer.rank","khm_customer.source","khm_customer.introduce","khm_customer.social_credit_code","khm_customer.corporation","khm_customer.corporation_card","khm_customer.register_capital","khm_customer.stablish_time","khm_customer.area","khm_customer.register_address",
					"khm_customer.industry","khm_customer.range","khm_customer.scale",
				]
			}]
		}, function(res, _sort_role) {
			sort_role = _sort_role;
			addList(res);
		});

		 //获取所有员工
        ykp.doAjax({
            url:'/api/api_employees/f7',
            method:'post',
            data:{
                select:'bmm_employees.id,bmm_employees.name,bmm_employees.department'
            },
            success:function(res) {
                var data = res.data; 
                for(var i in data) {
                    employees[data[i]['id']] = data[i]['name'];
                    employees_2[data[i]['id']] = data[i]['department'];
                }
            }
        });
		function doSearch() {
			var data = {
					url: '/api/api_customer/customer',
					method: 'post',
					data: {
						type:2,
						limit:pagesize,
						order: order
					}
				}
				cs.doSearch('#search', data, 'filter', false, function(res,_filter) {
					filter = _filter;
					if(res.data.items == "") {
					setTimeout(function(){
                        ykp.prompt('暂无数据！');
                    },1000);
						$('#datalist').html('<tr><td colspan="30"><div class="table-actions clearfix"></div> <div style="text-align: center;color:#7d7d7d" class="page">暂无数据</div></td></tr>');
						return false;
					} else {
						addList(res);
					}
				})
		}

		//cs.showHeightSearch('#heightsearch','#heightsearch1');

		advancedSearch();
		//高级搜索
		
		function advancedSearch(){
			var data = {
				url: '/api/api_customer/customer',
				method: 'post',
				data: {
					type: 2,
					limit: pagesize,
					order: order
				}
			}	
			cs.hSearch('#search1', data, 'filter', false, function(res, _filter) {
				filter = _filter;
				$('.in').removeClass('modal-backdrop');
				$("#heightsearch1").slideUp();
				$("#heightsearch").removeClass('active').css('z-index', '');
				if(res.data.items == "") {
					setTimeout(function(){
                        ykp.prompt('暂无数据！');
                    },1000);
					$('#datalist').html('<tr><td colspan="30"><div class="table-actions clearfix"></div> <div style="text-align: center;color:#7d7d7d" class="page">暂无数据</div></td></tr>');
				} else {
					addList(res);
				}
			})
		}

		cs.showHeightSearch('#heightsearch','#heightsearch1');

		/*$('.in').click(function() {
			if($('#heightsearch').hasClass('active')) {
				$('#heightsearch').removeClass('active').css('z-index', '');
				$("#heightsearch1").slideUp();
			}
		});
s

		$('#heightsearch').click(function() {
			if($(this).hasClass('active')) {
				$(this).removeClass('active');
				$("#heightsearch1").slideUp();
			} else {
				$("#heightsearch1").slideDown();
				$(this).attr('class', 'btn btn-info btn-sm active');
				cs.rest(false, '#heightsearch1');
			}
		})
*/

		$('#flush').click(function(){
			filter = '';
			ykp.setCookie("filter", "");
			ykp.setCookie("where", "");
			getList();
		})

		//getList(1);

		function getList(curpage,filter) {
			if (filter == undefined) {
				filter = '';
			}
			ykp.list({
				url: '/api/api_customer/customer',
				method: 'post',
				data: {
					type: 2,
					limit: pagesize,
					order: order,
					filter:filter
				},
				pageBar: {
					id: '#pageBar'
				},
				loadList: function(res) {
					if(res.data.items == "") {
						setTimeout(function(){
                        ykp.prompt('暂无数据！');
                    },1000);
						$('#datalist').html('<tr><td colspan="30"><div class="table-actions clearfix"></div> <div style="text-align: center;color:#7d7d7d" class="page">暂无数据</div></td></tr>');
						return false;
					}
					addList(res);
				}
			});
		}
		
		function addList(res) {
			var data = res.data.items;
			var html = "";
			var html = '';
			var ths = $('.thColor th');
			var styles = [];

			for(var i = 0;i < ths.length;i++){
				styles.push(ths.eq(i).css('display'));
			}
			var rank =''

			//经营范围
			var pd_data;
			//经营范围title
			var range_title = [];
			//遍历次数
			var times;
			var industry = ['','批发零售业','制造业','租赁和商务服务业','仓储运输业','餐饮住宿业','信息软件业','金融业','房地产业','建筑业','教育','文体娱乐业','卫生和社会工作','居民服务','修理业','农林牧渔业'];

			for(var i in data) {
                switch(data[i]['khm_customer.rank']){
					case '1':
						rank='A';
						break;
					case '2':
						rank='B';
						break;
					case '3':
						rank='C';
                        break;
					case '4':
						rank='D'
						break;
				}
				//获取经营范围title
				pd_data =  data[i]['khm_customer.range'];
				times = Math.ceil(pd_data.length / 20);
				for(var j = 0; j < times ; j++) {
					range_title.push(pd_data.slice(20*j,(j + 1) * 20));
				}
				
				html += `
					<tr data-id="${data[i]['khm_customer.id']}">
						<td  style="">
							<label class="pos-rel">
								<a> <span style="cursor: pointer" id="" title="详情" class="lbl btOrange sdetail"><i class="fa fa-info"></i></span></a>
                                 <a contentAuthority="109"> <span style="cursor: pointer" title="编辑" id="recordEdit" class="recordEdit lbl btBlue"><i class="fa fa-pencil-square-o"></i></span></a>
                             </label>
						</td>
						<td data-num="2" style="display: ${styles[1]}">${data[i]['khm_customer.customer_num']}</td>
						<td data-cid="${data[i]['khm_customer.id']}" data-num="3" style="display: ${styles[2]}"><a href="#" class="customerDetail pos-rel">${data[i]['khm_customer.name']}</a>
							<label class="pos-rel">
				 				<i class="iconBnt fa fa-info-circle" style="color:${data[i]['Remark'].length > 0 ? 'red' : ''}"  data-rel="tooltip" data-placement="right" data-html="true" title="${cs.getRemark(data[i]['Remark'])}" ></i>
			 				 </label>
						</td>
						<td data-num="4" style="display: ${styles[3]}">
							${rank}
						</td>
						
						<td data-num="5" style="display: ${styles[4]}">${data[i]['khm_customer.source']}</td>
						<td data-num="6" style="display: ${styles[5]}">${data[i]['khm_customer.introduce']}</td>
						<td data-num="7" style="display: ${styles[6]}">${data[i]['khm_customer.social_credit_code']}</td>
						<td data-num="8" style="display: ${styles[7]}">${data[i]['khm_customer.corporation']}</td>
						<td data-num="9" style="display: ${styles[8]}">${data[i]['khm_customer.corporation_card']}</td>
						<td data-num="10" style="display: ${styles[9]};text-align: right !important; ">${data[i]['khm_customer.register_capital']}</td>
						<td data-num="11" style="display: ${styles[10]}">${cs.getNowTime(data[i]['khm_customer.stablish_time'])}</td>
						<td data-num="12" style="display: ${styles[11]}">${data[i]['khm_customer.area']}</td>
						<td data-num="13" style="display: ${styles[12]}">${data[i]['khm_customer.address']}</td>
						<td data-num="14" style="display: ${styles[13]}">${industry[data[i]['khm_customer.industry']] || ""}</td>
						<td data-num="15" style="display: ${styles[14]}" title="${range_title.join('&#13;')}">
							<label style="width:100px;overflow: hidden;text-overflow: ellipsis;font-weight:normal;" >
				 				${data[i]['khm_customer.range']}
			 				</label>
						</td>
						<td data-num="16" style="display: ${styles[15]}">${data[i]['khm_customer.scale']}</td>
					</tr>
				`;

				//清空数组
		 		range_title = [];
			}
			$('#datalist').html(html);
			
			cs.getNodes([109]);
			//编辑
			editRecord();
				//详情
			dispDetail();
			custom.showReamrk();
			$("[data-rel='tooltip']").tooltip();
			custom.get_custom_info();
		}
		
		//编辑客户
			function editRecord() {
				$('#dynamic-table tbody #recordEdit').click(function() {
					showMark('#template1');
					$('#showBox .title').text('编辑客户');
					var data_id = $(this).parents('tr').attr('data-id');
					ykp.doAjax({
						url: '/api/api_customer/info',
						methods: 'post',
						data: {
							filter: 'khm_customer.id = ' + data_id
						},
						success:function(res) {
							var data = res.data;
						var area = data['khm_customer.area'];
						if(area) {
							area = area.split(',');
							$("#templateCon #city").citySelect({
								url: "/resource/adimin/assets/js/src/city.min.js",
								prov: area[0], //省份  
								city: area[1] ? area[1] : '', //城市  
								dist: area[2] ? area[2] : '', //区县  
								nodata: "none" //当子集无数据时，隐藏select  
							});
						} else {
							$("#templateCon #city").citySelect({
								url: "/resource/adimin/assets/js/src/city.min.js",
								prov: '北京', //省份 
								city: '东城区',
								nodata: "none" //当子集无数据时，隐藏select  
							});
						}
                            console.log(data);
                            for(let v in data) {
                                $('#templateCon').find('input,select,textarea').each(function (i,e) {
                                    if($(this).attr("title_") == "introduce" && v.replace(/khm_customer\./g,'') == "introduce"){
                                        let intro = data[v];
                                        let it = $(this);
										setTimeout(function () {
                                            it.val(intro).change();
                                        },1000)

                                    }else if($(this).attr("title_") == v.replace(/khm_customer\./g,'') ){
                                        if($(this).attr("title_") =="stablish_time"){
                                            $(this).val(cs.getNowTime(data[v]))
                                        }else {
                                            $(this).val(data[v])
										}
                                    }

                                })
                            }


						var inputOrSelectOrTextarea = $('#templateCon').find('input,select,textarea');
						/*inputOrSelectOrTextarea.eq(0).val(data['khm_customer.name']);
						if(data['khm_customer.rank']){
							inputOrSelectOrTextarea[1][data['khm_customer.rank']].selected = true;
						}
						inputOrSelectOrTextarea.eq(2).val(data['khm_customer.source']);
						inputOrSelectOrTextarea.eq(3).val(data['khm_customer.introduce']);
						inputOrSelectOrTextarea.eq(4).val(data['khm_customer.social_credit_code']);
						inputOrSelectOrTextarea.eq(5).val(data['khm_customer.corporation']);
						inputOrSelectOrTextarea.eq(6).val(data['khm_customer.corporation_card']);
						inputOrSelectOrTextarea.eq(7).val(data['khm_customer.register_capital']);
						inputOrSelectOrTextarea.eq(8).val(data['khm_customer.address']);
						inputOrSelectOrTextarea.eq(9).val(data['khm_customer.industry']);
						inputOrSelectOrTextarea.eq(10).val(data['khm_customer.range']);
						inputOrSelectOrTextarea.eq(11).val(data['khm_customer.scale']);
						//console.log(cs.getNowTime(data['khm_customer.stablish_time']));
						inputOrSelectOrTextarea.eq(12).val(cs.getNowTime(data['khm_customer.stablish_time']));
						inputOrSelectOrTextarea.eq(16).val(data['khm_customer.remark']);
						if(data['khm_customer.tax_type']){
							inputOrSelectOrTextarea[17][data['khm_customer.tax_type']].selected = true;
						}
						if(data['khm_customer.basic']){
							inputOrSelectOrTextarea[18][data['khm_customer.basic']].selected = true;
						}
						inputOrSelectOrTextarea.eq(19).val(data['khm_customer.ratepaying_no']);
						inputOrSelectOrTextarea.eq(20).val(data['khm_customer.state_tax_no']);
						inputOrSelectOrTextarea.eq(21).val(data['khm_customer.state_tax_pass']);
						inputOrSelectOrTextarea.eq(22).val(data['khm_customer.gca']);
						inputOrSelectOrTextarea.eq(23).val(data['khm_customer.local_tax_no']);
						inputOrSelectOrTextarea.eq(24).val(data['khm_customer.local_tax_pass']);
						inputOrSelectOrTextarea.eq(25).val(data['khm_customer.dca']);*/

						showIntroducer();
						}
					})


					showTaxMsg();

					//保存事件
					$('#templateCon .add').click(function() {
						var postData = {
							id: data_id
						};
						$('#templateCon').find('input,select,textarea').not(':hidden,.prov,.city,.dist').each(function(i, e) {
							postData[$(this).attr('title_')] = $(this).val();
						});
						var prov = $('#templateCon .prov').val();
						var city = $('#templateCon .city').val();
						//console.log(city ? city : '');
						var dist = $('#templateCon .dist').val();
						postData.area = (prov ? prov : '') + (city ? ',' + city : '') + (dist ? ',' + dist : '');
						postData.stablish_time = postData.stablish_time ?new Date(postData.stablish_time.replace(/[年月日]/g, '-')) / 1000 :'';
						var result = ykp.getFormData('#templateCon', true);
						if(result.status){
							ykp.doAjax({
							url: '/api/api_customer/edit',
							methods: 'post',
							data: postData,
							success:function(res) {
								//关闭弹出层
								cs.close();
						
								$('.ui-pagination-container').remove();
								getList(1);
							}
						})
						}
						
					})

					$('#showBox #photooptions li').eq(0).siblings().hide();

					//弹出层 客户证件上传
					$('#showBox #imgChosen').change(function() {
						var file = this.files[0];
						var fr = new FileReader();
						fr.readAsDataURL(file);
						fr.onloadend = function(e) {
							$('#showBox #idphoto').attr('src', e.target.result);
							$('#showBox #photooptions li').eq(0).siblings().show();
						}
					});

					//弹出层 成立日期
					cs.timeplug()
				})
			}
			
			var department = [];
			//获取所有部门
		    ykp.doAjax({
		        url:'/api/api_department/f7',
		        method:'post',
		        anysc:false,
		        data:{
		            select:'bmm_department.id,bmm_department.name,bmm_department.cid',
		            limit:999
		        },
		        success:function(res) {
		            var data = res.data;
		            if (data != '') {
		            	department = data;
		            }
		        }
		    });


			function dispDetail() {
				$('#dynamic-table tbody .sdetail').click(function() {
					showMark('#template');
					$('#showBox .title').text('客户详情');
					var cid = $(this).parents('tr').attr('data-id');
				ykp.doAjax({
					url: '/api/api_customer/info',
					methods: 'post',
					async:false,
					data: {
						filter: 'khm_customer.id = ' + cid
					},
					success: function(res) {
						var data = res.data;
						var srank = ["",'A', 'B', 'C', 'D'];
						var status = ['未合作','合作中','已解决'];
						var reason = ['无进行中的合同','合同已解约'];
						var department_c = [];
						var industry = ['','批发零售业','制造业','租赁和商务服务业','仓储运输业','餐饮住宿业','信息软件业','金融业','房地产业','建筑业','教育','文体娱乐业','卫生和社会工作','居民服务','修理业','农林牧渔业'];
						var lastdetail = {};
							for(var i in department){
							if (department[i]['cid']==cid) {
								department_c.push(department[i]);
							}
						}
						ykp.doAjax({
					        url:'/api/api_customer/get_last',
					        method:'post',
					        async:false,
					        data:{
					        	customer_id:cid,
					            limit:999
					        },
					        success:function(res) {
					        	lastdetail = res.data;
								$("#templateBox .disData0").html(data['khm_customer.customer_num']);
								$("#templateBox .disData1").html(data['khm_customer.name']);
								$("#templateBox .disData2").html(srank[data['khm_customer.rank']]);
								$("#templateBox .disData3").html(data['khm_customer.source']);
								$("#templateBox .disData4").html(data['khm_customer.introduce']);
								$("#templateBox .disData5").html(data['khm_customer.social_credit_code']);
								$("#templateBox .disData6").html(data['khm_customer.corporation']);
								$("#templateBox .disData7").html(data['khm_customer.corporation_card']);
								$("#templateBox .disData8").html(parseInt(data['khm_customer.register_capital']).toFixed(2));
								$("#templateBox .disData9").html(cs.getNowTime(data['khm_customer.stablish_time']));
								$("#templateBox .disData10").html(data['khm_customer.area']);
								$("#templateBox .disData11").html(data['khm_customer.address']);
								$("#templateBox .disData12").html(industry[data['khm_customer.industry']] || "");
								$("#templateBox .disData13").html(data['khm_customer.range']);
								$("#templateBox .disData14").html(data['khm_customer.scale']);
								$("#templateBox .disData15").html(data['khm_customer.remark']);
								$("#templateBox .disData16").html(data['khm_customer.tax_type'] == 2 ? "小规模" :"一般纳税人" );
								$("#templateBox .disData17").html(data['khm_customer.basic'] == 1 ? "有" : "无");
								$("#templateBox .disData18").html(data['khm_customer.ratepaying_no']);
								$("#templateBox .disData19").html(data['khm_customer.state_tax_no']);
								$("#templateBox .disData20").html(data['khm_customer.state_tax_pass']);
								$("#templateBox .disData21").html(data['khm_customer.gca']);
								$("#templateBox .disData22").html(data['khm_customer.local_tax_no']);
								$("#templateBox .disData23").html(data['khm_customer.local_tax_pass']);
								$("#templateBox .disData24").html(data['khm_customer.dca']);
								$("#templateBox .disData25").html(data['khm_customer.industry_no']);
								$("#templateBox .disData26").html(data['khm_customer.industry_pass']);
								$("#templateBox .disData27").html(data['khm_customer.ica']);
								$("#templateBox .disData28").html(status[data['khm_customer.status']]);
								$("#templateBox .disData29").html(employees[lastdetail.contract['update_by']]);
								$("#templateBox .disData32").html(customer_type[data['khm_customer.type']]);
								$("#templateBox .disData33").html(lastdetail.contract['status']>=3?reason[lastdetail.contract.status-3]:'----');
								$("#templateBox .disData34").html(lastdetail.contract['userInfo']==''?'----':lastdetail.contract['userInfo'] ?lastdetail.contract['userInfo']['name']:'----');
								$("#templateBox .disData35").html(lastdetail.contract['userInfo']==''?'----':lastdetail.contract['userInfo']?lastdetail.contract['userInfo']['dep_name']:'----');
								$("#templateBox .disData36").html(employees[data['khm_customer.create_id']]);
								$("#templateBox .disData37").html(department[parseInt(employees_2[data['khm_customer.create_id']])-1]?department[parseInt(employees_2[data['khm_customer.create_id']])-1]['name']:'----');
								$("#templateBox .disData38").html(data['khm_customer.contacts']);
								$("#templateBox .disData39").html(data['khm_customer.phone']);
								$("#templateBox .disData40").html(data['khm_customer.tel']);
                                $("#temHeader").width($("#showBox").width()-47);

					        }
					    });
						
					}
				})
				})

			}
			
			var customer_type = [];
		
		    //获取所有公海类型
		    ykp.doAjax({
		        url:'/api/api_customer_type/f7',
		        method:'post',
		        anysc:false,
		        data:{
		            select:'khm_customer_type.id,khm_customer_type.name'
		        },
		        success:function(res){
		            var data = res.data;
		            customer_type[0] = '无';
		            for(var i in data){
		            	customer_type[parseInt(i)+1] =data[i]['name'];
		            }	               
		        }
		    });


			function showTaxMsg() {
				$('#templateCon .more').click(function() {
					if($(this).hasClass('retract')) {
						$('#templateCon .taxMsg').hide();
						$(this).text('填写更多').removeClass('retract');
						return;
					}
					$(this).text('取消填写').addClass('retract');
					$('#templateCon .taxMsg').show();
				});
			}
			
			//选择弹出层来源中转介绍时，显示介绍人，
			//选择其他时，隐藏介绍人
			function showIntroducer() {
				var html = [];
				if($('#templateCon .source option:selected').index() == 1) {
					$('#templateCon .introducer').show();
				}
                if($('#templateCon .source').val() == '转介绍') {
                    transferto();
                }
				$('#templateCon .source').change(function() {
					//console.log(1);
					if(this.selectedIndex == 1) {
                        transferto();
					} else {
						$('#templateCon .introducer').hide();
					}
				});

				function transferto() {
                    $('#templateCon .introducer').show();
                    if(html.length == 0){
                        ykp.doAjax({
                            url:"/api/api_contact_book/grid",
                            method:"post",
                            data:{
                                select:'distinct(khm_contact_book.username) as "khm_contact_book.username"',
                                limit:999
                            },
                            success:function(res){
                                var data = res.data.items;

                                html.push('<option  value="">请选择</option>');
                                for(var i in data){
                                    html.push('<option  value="'+data[i]['khm_contact_book.username']+'">'+data[i]['khm_contact_book.username']+'</option>');
                                }
                                $('#templateBox #introducer').html(html.join(','));
                                //月份
                                $('#templateCon #introducer').select2({
                                    allowClear: true
                                });
                            }
                        })
                    }
                }
			}

		//自定义table
		cs.custorm_check('#dynamic-table', '#datalist', false);

		//分页
		cs.setPagination('#pagination', 5, 50, 5, getPageList);

		function getPageList(current) {
			//console.log(current);
		}

		$('.add').click(function() {
			showMark('.popup_new');
		});
		
		function editOrDetail(){
			$('#recordEdit').click(function(){
				showMark('.popup_new');
			});
			$('.sdetail').click(function(){
				showMark('.popup_new');
			});
		}
	});
</script>